.PHONY: paper clean cleanall revision

paper: stoeter_sourcecount.pdf

all: stoeter_sourcecount.pdf

preview: stoeter_sourcecount.pdf
	open $< &

clean:
	latexmk -CA
	rm -rf build

cleanall: clean
	- rm -f *.pdf

revision:
	echo '% Autogenerated, do not edit' > revision.tex
	echo "\\\newcommand{\\\revisiondate}{`git log -1 --format=\"%ad\" --date=short`}" >> revision.tex
	echo "\\\newcommand{\\\revision}{`git log -1 --format=\"%h\"`}" >> revision.tex

stoeter_sourcecount.pdf: stoeter_sourcecount.tex
	latexmk -pdf -pdflatex="pdflatex -interactive=nonstopmode" --synctex=1 -use-make stoeter_sourcecount.tex -output-directory=build
